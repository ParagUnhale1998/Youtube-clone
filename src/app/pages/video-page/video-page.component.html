<app-navbar></app-navbar>
<div class="flex justify-center items-start mt-4 px-10 pb-20 h-[90vh] container" style="overflow-y: scroll;">
    <div *ngIf="isLoading; else content" class="w-[65%] animate-pulse skeleton-loading video-container">
        <div class="video-card">
            <div class="bg-gray-300 rounded-lg w-[100%] h-[500px]"></div>
        </div>
        <div class="flex flex-col justify-start items-start gap-2 mt-4 px-2 video-info-container">
            <div class="container title">
                <div class="bg-gray-300 rounded w-full h-8"></div>
            </div>
            <div class="flex justify-around items-center w-full info-container">
                <div 
                    class="flex justify-start items-center gap-2 w-1/2 channel-info-container">
                    <div class="bg-gray-300 rounded-full w-10 h-10"></div>
                    <div class="flex flex-col justify-start items-start name-sub-container">
                        <div class="bg-gray-300 rounded w-1/2 h-4"></div>
                        <div class="bg-gray-300 rounded w-1/3 h-3"></div>
                    </div>
                </div>
                <div class="flex justify-self-end items-center gap-2 w-1/2 links-container">
                    <div
                        class="flex justify-center items-center gap-4 bg-gray-200 px-4 py-2 rounded-lg text-[20px] cursor-pointer btn">
                        <div class="bg-gray-300 rounded-full w-4 h-4"></div>
                        <div class="bg-gray-300 rounded w-12 h-4 text-[14px]"></div>
                    </div>
                    <div
                        class="flex justify-center items-center gap-4 bg-gray-200 px-4 py-2 rounded-lg text-[20px] cursor-pointer btn">
                        <div class="bg-gray-300 rounded-full w-4 h-4"></div>
                        <div class="bg-gray-300 rounded w-12 h-4 text-[14px]"></div>
                    </div>
                    <div
                        class="flex justify-center items-center gap-4 bg-gray-200 px-4 py-2 rounded-lg text-[20px] cursor-pointer btn">
                        <div class="bg-gray-300 rounded-full w-4 h-4"></div>
                        <div class="bg-gray-300 rounded w-12 h-4 text-[14px]"></div>
                    </div>
                </div>
            </div>
            <div class="bg-gray-200 px-4 p-2 rounded-lg w-full description-container">
                <div class="flex justify-start items-center gap-2 views-container">
                    <div class="bg-gray-300 rounded w-1/4 h-6"></div>
                    <div class="bg-gray-300 rounded w-1/4 h-6"></div>
                    <div class="flex justify-center items-center gap-2">
                        <div class="bg-gray-300 rounded h-4"></div>
                        <div class="bg-gray-300 rounded h-4"></div>
                        <div class="bg-gray-300 rounded h-4"></div>
                        <div class="bg-gray-300 rounded h-4"></div>
                        <div class="bg-gray-300 rounded h-4"></div>
                    </div>
                </div>
                <div class="mt-2">
                    <div class="bg-gray-300 rounded w-full h-5"></div>
                    <div class="bg-gray-300 mt-2 rounded w-3/4 h-5"></div>
                    <div class="bg-gray-300 mt-2 rounded w-full h-5"></div>
                    <div class="bg-gray-300 mt-2 rounded w-1/2 h-5"></div>
                </div>
            </div>
            <div class="w-1/2 comments-container" >
                <div class="bg-gray-300 m-2 pb-2 border-b-[1px] rounded w-1/2 h-12 font-bold text-2xl"></div>

                <!-- <div class="flex justify-start items-start gap-2 w-1/2 comment-card" *ngFor="let item of fakeLoopData">
                   
                    </div> -->
                <div class="flex flex-col justify-normal items-start gap-4">
                    <button class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg w-1/2"></button>
                    <button class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg w-1/2"></button>
                    <button class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg w-1/2"></button>
                    <button class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg w-1/2"></button>
                </div>


            </div>
        </div>
    </div>
    <ng-template #content>
        <div class="w-[65%] video-container">
            <div class="video-card">
                <iframe width="900" height="500" [src]="getVideoUrl(videoId)" frameborder="0" class="rounded-lg"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen></iframe>
            </div>
            <div class="flex flex-col justify-start items-start gap-2 mt-4 px-2 video-info-container">
                <div class="container title">
                    <h1 class="font-bold text-[20px]">{{videoDetail?.snippet.title}}</h1>
                </div>
                <div class="flex justify-around items-center w-full info-container">
                    <div class="flex justify-start items-center gap-2 w-1/2 channel-info-container">
                        <img class="rounded-full w-10" [src]="channelDetails?.snippet.thumbnails.default.url" alt="">
                        <div class="flex flex-col justify-start items-start name-sub-container">
                            <strong>{{videoDetail?.snippet.channelTitle}}</strong>
                            <span>{{channelDetails?.statistics.subscriberCount | numberAbbreviation}} subscribers</span>
                        </div>
                    </div>
                    <div class="flex justify-self-end items-center gap-2 w-1/2 links-container">
                        <div
                            class="flex justify-center items-center gap-4 bg-gray-200 px-4 py-2 rounded-lg text-[20px] cursor-pointer btn">
                            <i class="fa-regular fa-thumbs-up"></i>
                            <span class="text-[14px]">{{videoDetail?.statistics.likeCount | numberAbbreviation}} </span>
                        </div>
                        <div
                            class="flex justify-center items-center gap-4 bg-gray-200 px-4 py-2 rounded-lg text-[20px] cursor-pointer btn">
                            <i class="fa-share-from-square fa-regular"></i>
                            <span class="text-[14px]">Share</span>
                        </div>
                        <div
                            class="flex justify-center items-center gap-4 bg-gray-200 px-4 py-2 rounded-lg text-[20px] cursor-pointer btn">
                            <i class="fa-download fa-solid"></i> <span class="text-[14px]">Download</span>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-200 px-4 p-2 rounded-lg description-container">
                    <div class="flex justify-start items-center gap-2 views-container">
                        <strong> {{videoDetail?.statistics.viewCount | numberAbbreviation}}</strong>
                        <strong>{{ videoDetail?.snippet.publishedAt | date: 'mediumDate' }}</strong>
                        <ul class="flex justify-center items-center gap-2">
                            <li class="text-blue-600 hover:underline cursor-pointer"
                                *ngFor="let tag of videoDetail?.snippet.tags.slice(0, 3)">#{{ tag }}</li>
                        </ul>
                    </div>

                    <p class="mt-2"> {{videoDetail?.snippet.description}}</p>
                    <!-- {{videoDetail.tags}} -->
                </div>
                <div class="comments-container">
                    <h1 class="m-2 pb-2 border-b-[1px] font-bold text-2xl">Comments</h1>
                    <div class="flex flex-col justify-start items-start gap-4 comments-cards-container">
                        <div class="flex justify-start items-start gap-2 comment-card"
                            *ngFor="let item of videoComments">
                            <div class="image-container">
                                <img class="rounded-full w-10"
                                    [src]="item.snippet.topLevelComment.snippet.authorProfileImageUrl" alt="">
                            </div>
                            <div class="flex flex-col justify-start items-start gap-2 info-container">
                                <div class="flex justify-start items-start gap-2 title-container">
                                    <span
                                        class="font-semibold text-[12px]">{{item.snippet.topLevelComment.snippet.authorDisplayName}}</span>
                                    <span class="text-[12px]">{{item.snippet.topLevelComment.snippet.publishedAt |
                                        timeDifference}}</span>
                                </div>
                                <div class="comment-container">
                                    <p class="line-clamp-2 text-[14px]">
                                        {{item.snippet.topLevelComment.snippet.textOriginal}}</p>
                                </div>
                                <div class="like-container">
                                    <span> <i class="mr-1 fa-regular fa-thumbs-up"></i>
                                        {{item.snippet.topLevelComment.snippet.likeCount}}</span>
                                </div>
                            </div>
                        </div>
                        <button class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg">Show More</button>
                    </div>
                </div>

            </div>
        </div>
    </ng-template>

    <div class="w-[35%] related-video-container">
        <div *ngIf="isLoading; else relatedContent">
            <div class="flex flex-col justify-start items-start gap-4 ml-5 w-full card-containers">
                <!-- Skeleton for Video Cards -->
                <div class="flex justify-start items-start gap-2 hover:bg-slate-200 w-full cursor-pointer card"
                    *ngFor="let item of fakeLoopData">
                    <div class="bg-gray-300 rounded-lg w-1/2 h-[100px] video-card">
                        <div class=""></div>
                    </div>
                    <div class="flex flex-col justify-normal items-start gap-4 w-full">
                        <button class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg w-full"></button>
                        <button class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg w-full"></button>
                        <button class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg w-1/2"></button>

                    </div>
                </div>
            </div>
           
        </div>
        <ng-template #relatedContent>
            <div class="flex flex-col justify-start items-start gap-4 card-containers">
                <div class="flex justify-start items-start gap-2 hover:bg-slate-200 cursor-pointer card"
                    (click)="navigateToVideo(video.id.videoId,video.snippet.channelId)"
                    *ngFor="let video of relatedVideos.slice(0, displayCount)">
                    <div class="relative w-[30%] overflow-hidden image-container object-cover">
                        <img class="rounded-lg w-full object-cover" [src]="video.snippet.thumbnails.medium?.url"
                            alt="">
                    </div>
                    <div class="flex flex-col justify-between items-start p-2 info-container">
                        <strong>{{video.snippet.title | truncate:40}}</strong>
                        <p>{{video.snippet.channelTitle}}</p>

                    </div>
                </div>
                <button class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg"
                    *ngIf="displayCount < relatedVideos.length" (click)="showMore()">Show More</button>
            </div>
        </ng-template>
    </div>


    <!-- <iframe width="560" height="315" src="https://www.youtube.com/embed/qdLYbA9Mu_M?si=YBk8bnw7PjG2y6Zh" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe> -->